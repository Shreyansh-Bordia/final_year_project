{% extends 'base2.html' %}
{% block content %}
<h3 style="margin: 20px 0 0 50px;">Consultation Room</h3>
<div id="messages" style="height: 480px; margin: 20px 0 0 50px;"></div>
<input id="msg" autocomplete="off" style="margin:0 0 50px 50px;"><button onclick="sendMsg()">Send</button>

<script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
<script>
    const socket = io("/chat");
    const room = "{{ room_id }}";
    socket.emit('join', { room });

    socket.on('message', function(data) {
        const div = document.createElement('div');
        div.innerText = data;
        document.getElementById('messages').appendChild(div);
    });

    function sendMsg() {
        const msg = document.getElementById("msg").value;
        socket.emit('send_message', { room: room, message: msg });
        document.getElementById("msg").value = "";
    }
</script>
{% endblock %}
